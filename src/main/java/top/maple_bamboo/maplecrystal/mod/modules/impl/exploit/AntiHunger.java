/*
 * Decompiled with CFR 0.152.
 * 
 * Could not load the following classes:
 *  net.minecraft.network.packet.Packet
 *  net.minecraft.network.packet.c2s.play.ClientCommandC2SPacket
 *  net.minecraft.network.packet.c2s.play.ClientCommandC2SPacket$Mode
 *  net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket
 */
package top.maple_bamboo.maplecrystal.mod.modules.impl.exploit;

import net.minecraft.network.packet.Packet;
import net.minecraft.network.packet.c2s.play.ClientCommandC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;
import top.maple_bamboo.maplecrystal.api.events.eventbus.EventListener;
import top.maple_bamboo.maplecrystal.api.events.impl.PacketEvent;
import top.maple_bamboo.maplecrystal.asm.accessors.IPlayerMoveC2SPacket;
import top.maple_bamboo.maplecrystal.mod.modules.Module;
import top.maple_bamboo.maplecrystal.mod.modules.impl.player.AutoPearl;
import top.maple_bamboo.maplecrystal.mod.modules.settings.impl.BooleanSetting;

public class AntiHunger
extends Module {
    public static AntiHunger INSTANCE;
    private final BooleanSetting sprint = this.add(new BooleanSetting("Sprint", false));
    private final BooleanSetting ground = this.add(new BooleanSetting("Ground", true));

    public AntiHunger() {
        super("AntiHunger", Module.Category.Exploit);
        this.setChinese("\u9632\u6389\u9971\u98df\u5ea6");
        INSTANCE = this;
    }

    @EventListener(priority=-100)
    public void onPacketSend(PacketEvent.Send event) {
        if (BowBomb.send) {
            return;
        }
        if (AutoPearl.throwing || Phase.INSTANCE.isOn()) {
            return;
        }
        Packet<?> packet = event.getPacket();
        if (packet instanceof ClientCommandC2SPacket) {
            ClientCommandC2SPacket packet2 = (ClientCommandC2SPacket)packet;
            if (this.sprint.getValue() && packet2.getMode() == ClientCommandC2SPacket.Mode.START_SPRINTING) {
                event.cancel();
            }
        }
        if (event.getPacket() instanceof PlayerMoveC2SPacket && this.ground.getValue() && AntiHunger.mc.player.fallDistance <= 0.0f && !AntiHunger.mc.interactionManager.isBreakingBlock()) {
            ((IPlayerMoveC2SPacket)event.getPacket()).setOnGround(false);
        }
    }
}

